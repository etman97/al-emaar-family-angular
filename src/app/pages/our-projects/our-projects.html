<section class="hero-search-section">
  <div class="search-bar">
    <div class="search-segment search-input-segment">
      <input 
        type="text" 
        [(ngModel)]="searchText"
        [placeholder]="'OUR_PROJECTS.SEARCH.PLACEHOLDER' | translate" 
        [attr.aria-label]="'OUR_PROJECTS.SEARCH.PLACEHOLDER' | translate" 
      />
      <span class="search-icon" aria-hidden="true"></span>
    </div>

    <div class="dropdown-wrapper">
      <button class="search-segment" type="button" (click)="toggleLocationDropdown($event)">
        <span class="segment-label">{{ selectedLocation || ('OUR_PROJECTS.SEARCH.LOCATION' | translate) }}</span>
        <span class="caret"></span>
      </button>
      <div class="dropdown-menu" *ngIf="showLocationDropdown" style="display: flex !important; flex-direction: column !important;">
        <button 
          *ngIf="selectedLocation" 
          class="dropdown-item clear-option" 
          type="button"
          (click)="clearLocationFilter(); $event.stopPropagation()">
          <i class="bi bi-x-circle" style="margin-inline-end: 6px;"></i>
          {{ 'OUR_PROJECTS.SEARCH.CLEAR' | translate }}
        </button>
        <button 
          *ngFor="let location of uniqueLocations" 
          class="dropdown-item" 
          type="button"
          (click)="selectLocation(location); $event.stopPropagation()">
          <i class="bi bi-geo-alt" style="margin-inline-end: 8px; opacity: 0.6;"></i>
          {{ currentLang === 'ar' ? location.ar : location.en }}
        </button>
      </div>
    </div>

    <div class="dropdown-wrapper">
      <button class="search-segment" type="button" (click)="togglePropertyTypeDropdown($event)">
        <span class="segment-label">{{ selectedPropertyType || ('OUR_PROJECTS.SEARCH.PROPERTY_TYPE' | translate) }}</span>
        <span class="caret"></span>
      </button>
      <div class="dropdown-menu" *ngIf="showPropertyTypeDropdown" style="display: flex !important; flex-direction: column !important;">
        <button 
          *ngIf="selectedPropertyType" 
          class="dropdown-item clear-option" 
          type="button"
          (click)="clearPropertyTypeFilter(); $event.stopPropagation()">
          <i class="bi bi-x-circle" style="margin-inline-end: 6px;"></i>
          {{ 'OUR_PROJECTS.SEARCH.CLEAR' | translate }}
        </button>
        <button 
          *ngFor="let type of uniquePropertyTypes" 
          class="dropdown-item" 
          type="button"
          (click)="selectPropertyType(type); $event.stopPropagation()">
          <i class="bi bi-building" style="margin-inline-end: 8px; opacity: 0.6;"></i>
          {{ currentLang === 'ar' ? type.ar : type.en }}
        </button>
      </div>
    </div>

    <button class="search-segment search-button" type="button" (click)="performSearch()">{{ 'OUR_PROJECTS.SEARCH.SEARCH_BUTTON' | translate }}</button>
  </div>
</section>

<section class="projects-section">
  <div class="container">
    <h2 class="projects-title">{{ 'OUR_PROJECTS.TITLE' | translate }}</h2>
    
    <div class="tabs">
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'all'"
        (click)="setTab('all')"
        type="button">
        {{ 'OUR_PROJECTS.TABS.ALL' | translate }}
      </button>
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'current'"
        (click)="setTab('current')"
        type="button">
        {{ 'OUR_PROJECTS.TABS.CURRENT' | translate }}
      </button>
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'past'"
        (click)="setTab('past')"
        type="button">
        {{ 'OUR_PROJECTS.TABS.PAST' | translate }}
      </button>
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'upcoming'"
        (click)="setTab('upcoming')"
        type="button">
        {{ 'OUR_PROJECTS.TABS.UPCOMING' | translate }}
      </button>
    </div>

    <div class="projects-grid" [@projectsAnimation]="getAnimationState()">
      @for (project of filteredProjects; track project.id) {
        <div class="project-card" (click)="onProjectClick(project)" style="cursor: pointer;">
          <img [src]="project.images && project.images.length > 0 ? project.images[0] : project.image" [alt]="project.name[currentLang]" />
          <div class="project-overlay">
          <div class="type-badge">{{ project.type[currentLang] }}</div>
            <h3>{{ project.name[currentLang] }}</h3>
          </div>
        </div>
      }
    </div>
  </div>
</section>


